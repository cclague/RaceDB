{% extends "base.html" %}

{% block content %}
{% load i18n %}
{% load crispy_forms_tags %}

<h2 class="hidden-print">{{title}}</h2>
{% trans "Generated" %}: {{time_stamp|date:"Y-m-d H:i:s"}}
<h2><strong>{{instance.competition.name}}</strong></h2>
<h2><strong>{{instance.name}}</strong>: {{instance.date_time}}</h2>
<div class="hidden-print">
<hr/>
<button class="btn btn-primary" id="focus" onClick="window.print()"><span class="glyphicon glyphicon-print"></span>&nbsp;&nbsp;{% trans "Print" %}</button>
&nbsp;&nbsp;&nbsp;&nbsp;
<a class="btn btn-primary" href="{{cancelUrl}}">{% trans "OK" %}</a>
<hr/>
</div>
<h2 class="visible-print">{% trans "Waves" %}</h2>
<table class="table table-striped table-hover">
<thead>
	<tr>
		<th>{% trans "Wave" %}</th>
		<th>{% trans "Start Offset" %}</th>
		<th>{% trans "Categories" %}</th>
		<th class="text-center">{% trans "Starters" %}</th>
		<th class="hidden-print"></th>
	</tr>
</thead>
<tbody>
	{% for w in instance.wave_set.all %}
		<tr onclick="jump('{{path}}WaveEdit/{{w.id}}/');">
			<td>{{w.name}}</td>
			<td>{{w.start_offset}}</td>
			<td>{{w.category_text}}</td>
			<td class="text-center">{{w.get_participants.count}}</td>
			<td class="hidden-print">
				<a class="btn btn-warning" href="{{path}}WaveDelete/{{w.id}}/">{% trans "Delete" %}</a>
				<a class="btn btn-success" href="{{path}}WaveEdit/{{w.id}}/">{% trans "Edit" %}</a>
			</td>
		</tr>
	{% endfor %}
</tbody>
</table>
{% spaceless %}
<div class="hidden-print">
{% with duplicate_bibs=instance.get_duplicate_bibs %}
	{% if duplicate_bibs %}
		<hr/>
		<h2>{% trans "Duplicate Bib Numbers:" %}</h2>
		{% for db in duplicate_bibs %}
			{{db}}<br/>
		{% endfor %}
	{% endif %}
{% endwith %}
</div>
{% endspaceless %}
<style>
	table.participant_table tr td {
		font-size: 75%;
	}
	table.participant_table tr th {
		font-size: 75%;
	}
</style>
<h2>{% trans "Start Lists" %}</h2>
{% for w in instance.wave_set.all %}
<hr/>
<h4><strong>{{w.name}}</strong>: {% trans "Offset" %}: {{w.start_offset}}, {{w.category_text}} <strong>{% trans "Starters" %}: {{w.get_participants.count}}</strong></h4>
{% spaceless %}
<table class="table table-striped table-hover table-condensed participant_table">
<thead>
	<tr>
		<th>{% trans "Bib" %}</th>
		<th>{% trans "Name" %}</th>
		<th>{% trans "Team" %}</th>
		<th>{% trans "Category" %}</th>
		<th class="hidden-print"></th>
	</tr>
</thead>
<tbody>
	{% for p in w.get_participants %}
		{% with h=p.license_holder %}
		<tr onclick="jump('{{path}}ParticipantEdit/{{p.id}}/');">
			<td>{% if p.bib %}{{p.bib}}{% endif %}</td>
			<td>{{p.license_holder.full_name}}</td>
			<td>{% if p.team %}{{p.team.name}}{% endif %}</td>
			<td>{% if p.category %}{{p.category.code}}{% endif %}</td>
			<td class="hidden-print">
				<a class="btn btn-warning" href="{{path}}ParticipantDelete/{{p.id}}/">{% trans "Delete" %}</a>
				<a class="btn btn-success" href="{{path}}ParticipantEdit/{{p.id}}/">{% trans "Edit" %}</a>
			</td>
		</tr>
		{% endwith %}
	{% endfor %}
</tbody>
</table>
{% endspaceless %}
{% endfor %}
{% endblock content %}
