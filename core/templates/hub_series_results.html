{% extends "base.html" %}
{% load i18n %}
{% block content %}

<style>
table.results-table tr td {
	font-size: 85%;
}
table.results-table tr th {
	font-size: 85%;
}
.col-border-right {
    border-right: 1px solid #aaaaaa;
}
.result-detail {
	font-style: italic;
	color: #080808; 
}
</style>

{% include "hub_nav.html" %}
<h1>
	<strong>{{series.name}}</strong> <span style="font-size: 75%">{{series.description}}</span><br/>
	<span style="font-size: 75%">
		{% for c in group_categories %}{% if not forloop.last %}, {% endif %}{{c.code_gender}}{% endfor %}
	</span>
</h1>
{% trans "Generated" %}: {{time_stamp|date:"Y-m-d H:i:s"}}
{% spaceless %}
<table class="table table-striped table-hover table-condensed results-table" style="width: auto;">
<thead>
	<tr>
		<th></th>
		<th>{% trans "Name" %}</th>
		<th>{% trans "Team" %}</th>
		<th class='text-right'>
			{% if series.ranking_criteria == 1 %}
				{% trans "Time" %}
			{% else %}
				{% trans "Points" %}
			{% endif %}
		</th>
		<th class='text-right col-border-right'>{% trans "Gap" %}</th>
		{% for e in events %}
			<th colspan="2" class="text-center col-border-right">
				{{e.competition.name}}<br/>
				{{e.date_time|date:"N d, Y"}}<br/>
				<a href='/RaceDB/Hub/CategoryResults/{{e.id}}/{{e.event_type}}/{{category.id}}/'>{{e.name}}</a><br/>
			</th>
		{% endfor %}
	</tr>
</thead>
<tbody>
	{% for lh, team, totalValue, gap, event_results in results %}
		<tr>
			<td class="text-right">{{forloop.counter}}</td>
			<td><a href='/RaceDB/Hub/Hub/LicenseHolderResults/{{lh.id}}/'>{{lh.full_name}}</a></td>
			<td>{{team}}</td>
			<td class='text-right'>{{totalValue}}</td>
			<td class='text-right col-border-right'>{% if forloop.counter != 1 %}{{gap}}{% endif %}</td>
			{% for er in event_results %}
				{% if er %}
					<td class='text-right {% if er.ignored %}ignored{% endif %}'>
						{{er.value_for_rank}}{% if er.ignored %}&nbsp;&#x2021;{% endif %}
					</td>
					<td class='text-right col-border-right result-detail'>
						{{er.rank_text}}{% if er.upgraded %}&nbsp;&#x2021;&#x2021;{% endif %}
					</td>
				{% else %}
					<td></td>
					<td class='col-border-right'></td>
				{% endif %}
			{% endfor %}
		</tr>
	{% endfor %}
</tbody>
</table>
{% endspaceless %}
{% if has_ignored %}
	<p>&#x2021; - {% trans "Result ignored: better result available." %}</p>
{% endif %}
{% if has_upgrades %}
	<p>&#x2021;&#x2021; - {% trans "Result from upgrade." %}</p>
{% endif %}
{% if series.must_have_completed > 0 %}
	<p>
	{% trans "Competitors must complete" %} {{series.must_have_completed}} {% trans "Events to be eligible." %}
	</p>
{% endif %}
{% if series.best_results_to_consider > 0 %}
	<p>
	{% trans "Best" %} {{series.best_results_to_consider}} {% trans "results considered." %}
	</p>
{% endif %}
<h3>
{% if series.ranking_criteria == 0 %}
	{% trans "Ranked by Points" %}
{% elif series.ranking_criteria == 1 %}
	{% trans "Ranked by Time" %}
{% elif series.ranking_criteria == 2 %}
	{% trans "Ranked by % Winning Time / Finish Time" %}
{% endif %}
</h3>
<p/>
<h4>{% trans "Tie-breaking Rules" %}</h4>
<ol>
{% if series.ranking_criteria != 1 and series.consider_most_events_completed %}
	<li>{% trans "Number of Events participated." %}  {% trans "If still a tie:" %}</li>
{% endif %}
{% if series.tie_breaking_rule %}
	<li>{{series.get_tie_breaking_rule_display}}.  {% trans "If still a tie:" %}</li>
{% endif %}
	<li>{% trans "Most recent result." %}</li>
</ol>
{% if series.ranking_criteria == 0 and points_structure_summary %}
	<p/>
	<h4>{% trans "Points Structures" %}</h4>
	{% if points_structure_summary|length == 1 %}
		{% for ps, evts in points_structure_summary %}
			{{ps}}
		{% endfor %}
	{% else %}
		<ol>
		{% for ps, evts in points_structure_summary %}
			{{ps}}: {% for e in evts %}{% if not forloop.first %}, {% endif %}{{e.name}}{% endfor %}
		{% endfor %}
		</ol>
	{% endif %}
{% endif %}

{% endblock content %}
